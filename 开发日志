2017-03-19 17:07:20
发现驱动人物状态变化的入口不唯一,导致逻辑写的很多地方有重复,就拿我怎么判断一个小怪死掉了,并且换到死亡状态,现在在所有的state的update方法中有判断
在所有的received方法中有判断是否到了DiedCMd 而且 所有的livingThings的循环中也有判断,saveTask中也有判断.
如果所有的应该在源头就收拢这个控制,也就是说要在主要的循环中控制,但是住循环又分为 客户端循环 服务端循环 ,感觉可以用同一个server 去处理,如果有同一个service 去处理会好一点
mainlivingthingloopService
其次混乱点在于 一部分业务逻辑 再manager里 一部分逻辑在 state 的 update里 这就感觉很混乱.
那要不就规定 所有的state 不用判断用户的死亡或者其他什么的

暂时把方法移到state 和livingThingmanager里面了 但是发现死亡动画 和 移动的速度 怪物的攻击力 还有移动的角度 都不太满意
移动角度已经解决
新增问题 timer定时器 会停止工作
主角会死 但是 客户端的血量永远是满的
少血没有显示
最后一击血量客户端血条没有归零 对方就死了

2017-3-20 08:59:25
被攻击了之后没有移动 快死了没有动画 可能是动画重叠了 先清除看看看

2017-3-22 18:53:26
扔出的东西id之后变得和服务器不一样了 这个需要测查
2017-3-22 18:53:46
掉落的物品应该找个时间同步一遍
2017-3-22 18:56:00
捡取的事件不能不停的发送万一没能捡起来呢
捡取的事件能不能进行同步发送
需要增加一个删除世界物品的事件
saveTask需要增加trycatch 不然就崩掉了
