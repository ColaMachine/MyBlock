2017-03-19 17:07:20
发现驱动人物状态变化的入口不唯一,导致逻辑写的很多地方有重复,就拿我怎么判断一个小怪死掉了,并且换到死亡状态,现在在所有的state的update方法中有判断
在所有的received方法中有判断是否到了DiedCMd 而且 所有的livingThings的循环中也有判断,saveTask中也有判断.
如果所有的应该在源头就收拢这个控制,也就是说要在主要的循环中控制,但是住循环又分为 客户端循环 服务端循环 ,感觉可以用同一个server 去处理,如果有同一个service 去处理会好一点
mainlivingthingloopService
其次混乱点在于 一部分业务逻辑 再manager里 一部分逻辑在 state 的 update里 这就感觉很混乱.
那要不就规定 所有的state 不用判断用户的死亡或者其他什么的

暂时把方法移到state 和livingThingmanager里面了 但是发现死亡动画 和 移动的速度 怪物的攻击力 还有移动的角度 都不太满意
移动角度已经解决
新增问题 timer定时器 会停止工作
主角会死 但是 客户端的血量永远是满的
少血没有显示
最后一击血量客户端血条没有归零 对方就死了

2017-3-20 08:59:25
被攻击了之后没有移动 快死了没有动画 可能是动画重叠了 先清除看看看

2017-3-22 18:53:26
扔出的东西id之后变得和服务器不一样了 这个需要测查
2017-3-22 18:53:46
掉落的物品应该找个时间同步一遍
2017-3-22 18:56:00
捡取的事件不能不停的发送万一没能捡起来呢
捡取的事件能不能进行同步发送
需要增加一个删除世界物品的事件
saveTask需要增加trycatch 不然就崩掉了
2017-03-22 21:17:36捡去测试
完成最后一击的时候对方没有立刻死
打算显示血槽的数值
修正伤害计算错误
对方玩家的移动闪现化.
2017-3-23 11:54:26
装备位置错误 盔甲 和头盔 大小 位置错误
ComplexEquipProperties设置setinfo的时候handEquip是2
2017-03-25 23:55:12
修正了盔甲显示黑色问题 纹理管理器创建了两次引起
解决盔甲大小不合身问题.
解决头盔前部显示不对问题
让砍变成范围攻击 非选取攻击
发现bug 穿戴斧子的时候有问题
2017-03-26 13:26:42
对component进行归类
2017-03-26 18:59:34
增加无目标攻击 增加砍的动画
2017-03-26 20:05:16
自动寻找近战攻击目标 ,增加砍的实际效果
2017-03-26 21:13:07
增加砍后的击飞效果 其实是往后跳跃的意思 jump命令
2017-03-26 21:14:10
水饺
2017-03-28 21:59:26
被击退的数据没有上传到服务器 导致服务器位置数据不正确
地形数据上传到服务器 客户端改为从服务器端获取地形数据

2017-04-04 22:32:31
感觉所有的物品都要增加3个属性
1个是再手里是什么形状的
2是再身体上是什么形状的
3是再外界是什么形状的

或者是类型属性
物品简单分类 食物 wear weapon block(不能在身上 可以在手上 可以再)
现在的问题 是 怎么把以String类型的name属性来区分block类型的物品 切换成 以enum 类型为区分标准
2017-4-6 12:20:09
修正人物的大小 调整人物在镜头中的位置 调整人物的移动速度
2017-04-07 22:32:07
block 类型物品再世界掉落应该是一个方块结构 在背包栏里显示也是一个伪3d效果
2017-04-08 13:14:02
item 初步修正 究竟是itembean 包含 component 还是component 包含itemBean;
打算虚化component 以前component 是一个盒子
需要有个地方记录下当前是再哪个环境下 身上 还是手上 还是野外 还是放置

2017-04-15 00:26:46
增加了shaderManager 的shadow的config的创建 initProgram 和uniform改造
修改了box.frag 和box.vert 增加了frag深度纹理的传输和计算
2017-04-16 13:16:35
增加shadow
解决光块不现实问题 发现一个重大bug 取shaderuniform的位置的时候 如果取不到的时候是-1 当初使用>0来判断的 导致位置是0的时候就不赋值了
 不应该每次都绘制阴影贴图 而应该再方块有变动后生成1次纹理贴图

 2017-04-22 16:22:43
 出现了万花筒的样子不知道是为何引起的,可能是draw2dimg
 2017-04-22 19:55:02依然没有查出是什么原因引起的万花筒
 包结构重新整理后 colorbuffer[0]又不正确了, pingpongbuffer 渲染然也不正确 看来要重新校对hdrTexuture了
 2017-04-22 22:17:28 发现hdrTexuterid 也不正确
 发现是hdr 的问题 没有执行init方法 是不是所有的texutureid调用的时候都要判断下 不能为0 (已经加上)
 阴影又不对了 天呐
 渲染出来的阴影texture 居然是非红图
 发现把hdr 关闭了就正常了
问题应该处在hdr的init 加上前后的代码 因为我只要把init方法注释掉后就正常了, 如果加上去 感觉里面的纹理就变成另一个了
depthMapBuffer 感觉被污染了

问题好像找到了 是glBindText引起 尝试用GL13.glActiveTexture(GL13.GL_TEXTURE0);帮他们格力开来

pingpong的texture 依然存在之前的问题 渲染的结果莫名其妙 一团黑的 边上有几点粉红色.这是因为我没有开启bloom的渲染缓存,但是直接地在屏幕上渲染只有右上角一点稍微对
现在试着去渲染colorbuffer看看有没有之前的万花筒效应 colorbuffer还是万花筒 真是绝望了
接下来我要检查shader 和我的shaderUtils.draw2dimg是否有问题

感觉没有落入pingpongBuffer 把10次缩减为1次查看pingpongbuffer[1] 是有的
感觉每次都缩减1/2引起的 修改和我的shaderUtils.draw2dimg
为什么对一张items进行高斯模糊 有概率会呈现出从上到下 变黑的缓慢效果 还有以colorbuffer[1]为原图 高斯 会全黑
如果把gaosi.frag改成原图输出就会有结果 ,但是如果改成 正常的高斯程序就会全黑
再提取亮色的地方bloom.frag把亮度提高为200
奇怪了把代码还原为上上步 又出不来了
原来是我重启了之后没有百块导致的
2017-04-28 22:02:27 胸部太突出

2017-04-29 11:01:58 装备的修改没有及时体现出来
原来是判断id是player的id 就自动continue了

2017-04-29 12:30:37 TODO bagChangeHandler 和equip changeHandle 要不要结合起来
2017-04-29 16:58:36 MouseControlCenter 代码整理

2017-04-30 15:03:42 增加功能 一键回到人物视角,增加准星
2017-04-30 15:52:12 增加功能 鼠标按下的时候攻击准信对准的物品 改为使用v键 对物品产生作用,如果是拆卸的话需要有一个进度,首先标记下对应的物体
然后每次循环都判断当前物体是不是之前的物体,如果不是就重新开始
按了v 出现破碎动画效果
2017-05-01 10:14:19
2017-05-01 16:33:32让所有物体去掉color 属性的影响 json 文件增加注释的功能 改为不依靠color 属性
文件读取里屏蔽注释
2017-05-01 21:57:30 解决服务器传输的地形生成 和本地完全不同问题
2017-05-01 23:34:11 超过指定高度的东西就不显示了 貌似之前的设定是高度y是16而不是128 还是没有解决高度16问题
2017-05-02 21:07:44解决超过已定高度就没有方块,原来是自己写着y<16进行循环了
2017-05-02 21:08:17 glass 无法显示
2017-05-02 21:54:14 实现树 先写死一个树的形状
2017-05-07 22:56:15 实现先种了种子 然后种子发育成树 需要有个定时任务去作这个事情 <== 先实现不同的 物品 放置的时候效果不同
2017-5-10 19:04:01 种子发育成树 感觉需要在服务器做这个事情 或者在
2017-5-17 19:39:01 先实现了一个简单的种子生长器 在服务端 做的,但是没有同步到客户端
2017年5月17日20:47:46将种子的生长从客户端做到了服务器端 并同步到客户端
2017年5月17日20:51:49准备实现可开合的简单木门
2017-05-21 18:00:15 如何实现门的开合状态呢 我是说得再chunkimpl 里记录下当前的方块的状态,
2017-05-21 21:28:13 错了 我需要另外一个数组类似的集合记录下有状态值的方块的状态,因为大多数方块是没有状态的
2017年5月23日19:06:12 美化按钮 可以根据一个grid图片来显示 mc是直接一张图片
目标 实现光照方块计算 水分光照计算
2017年5月23日20:05:49 实现block 数据存储到本地
2017-05-28 21:27:39 物品代码抽象出 block itemFactory baseon的新特性,加完之后门显示不出来了 要把所有物品的放置 和 使用收敛
2017-05-29 14:07:44 通过新的引擎模式 实现什么呢 实现放置了一个
2017-05-30 08:26:39 拆掉东西的时候报错 (WorldRendererLwjgl.java:153)
2017-05-30 13:10:50 修正好才方块,copydownblock被拆的时候主块没有消失 是不是attack方块的时候也要落入到方块的内部逻辑中去实现
2017-05-30 15:25:46 definition 的解析 继承作的还不够好
2017-05-30 15:30:42 我先设计箱子好还是狗好 从玩的角度来看 连怪物都没设计好  狼模型建立 贴图不对

2017年5月31日16:22:42 增加包裹 任务属性面板 开关
2017年6月4日08:29:19 chunksInProximity 和nearcache 没有同步数据导致有些方块没有加载 walkcmd walkstate 没有判断当前的y
发现是网络堵塞引起的 还有网络 那我是不是应该把所有的数据先放入缓冲区 然后从缓冲区 这部分我决定好好看下netty源码
狗狗的贴图重做 利用自己写的canvas绘制
2017-6-5 11:59:50 射出的箭碰到方块停止运动
2017-06-09 22:39:32 人物走动 但是动作太慢 然后是怎么
2017-06-09 23:59:24改成分段的时候走路卡顿严重 并且镜头没有发生变化
2017-06-10 00:15:47 怎么把走路的命令变得无缝化起来也就是说我允许一定的队列
2017-06-10 22:54:29 虽然我把方向键变成一堆指令同步给服务器 但是感觉很奇怪 因为也只有作为主玩家的时候这些方向键才有意义,如果是别的玩家,这些数据还没有制定开始移动的位置 结束移动的位置来的有意义
我们可以把一个玩家的移动翻译成若干个直线线段 怎么弄呢 如果用户按下一个w键表示一个射线 服务器将表示一个玩家从该位置出发朝某个方向移动,
如果这个时候按下a键 表示玩家从一个点往某个方向移动 所以所有的移动都是射线 那么所有的walkstate 都是可以被打断的 但是不能被w键打断
也就是说当用户持续的按着w键对于服务器来说只接受到了最初的w移动 既从某个点朝某个方向移动,这个时候如果接受到了w释放 那么就像服务器发出我在某点停住的事件

也就是我要收集当前的wasd 状态 然后形成 w wa a sa s sd d dw 这四种状态吗

这8中都会中断之前的行走状态 并产生新的行走状态
然后 就出现了 wasd 四键都不按的事件 会中断之前的状态
先试试看这个理念能否实现的通吧

初步实现了丝滑的行走.
如何体现人物的旋转,解决任务bodyangle的nan问题

2017年6月12日10:48:16
走路的过程中如果任务发生了旋转

2017-06-18 10:48:55
用命令刷怪 /give 1 wolf 1
攻击

2017-06-18 14:52:55
说话太多 自动过滤掉以前的内容

2017-06-18 15:16:51
客户端并没有收到chase的命令 看了服务器的代码觉得chase的命令能被walkcmd取代
客户端和服务器的位置不一致
经常出现重新定位的情况
改成那个以后怪物移动了之后就出现了i移动之后丢失目标的情况
很可能是服务器端和客户端两者的速度是不一样的

SaveTask


增加目的地属性
实时计算当前位置和目标位置并产生移动效果

2017-07-12 23:58:08 增加木箱子
2017-07-13 22:17:35希望木箱子按使用键能打开包裹
2017年7月14日10:03:47 木箱需要一个id 或者通过xyz计算出id
block vlaue
box
创建BoxBean在内存中

create  生成id id 为 x_y_z_itemtype 默认生成的时候itembeanlist是空的
update  更新发生在内部物品发生变化的时候 1移出物品 2调换位置 3放入武平 4交换物品
delete  发生在被砸的时候 物品全部掉落到周围
cmd: boxopencmd箱子状态命令 boxItemcmd 箱子物品请求命令

调用除湿的地方  创建controller  客户端 service cmd CmdUtil  handler cmdtype servermain  服务端service client 接受 manager 接收处理
2017年7月27日23:18:02
希望能够统一建模型的地方 并提供灵活的手段 让模型能够随着状态 变化
目前的模行
2017年8月1日19:33:16
拟减少 限制getBlock的使用
esc的时候关闭所有的窗口

